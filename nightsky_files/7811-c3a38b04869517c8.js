"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7811],{86512:function(e,t,l){l.d(t,{C:function(){return O}});var s=l(85893),i=l(47340),r=l(30313),n=l(67294);function a(e){let{size:t=16,className:l}=e;return(0,s.jsxs)(r.ny,{width:t,height:t,viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",className:l,children:[(0,s.jsx)("path",{d:"M4.3865 12.607C4.41157 12.9849 4.56242 13.3382 4.80893 13.5964C5.05543 13.8547 5.37946 13.9988 5.71628 14H10.2834C10.6202 13.9988 10.9442 13.8547 11.1907 13.5964C11.4373 13.3382 11.5881 12.9849 11.6132 12.607L12.0327 6H3.96695L4.3865 12.607Z"}),(0,s.jsx)("path",{d:"M12.8887 4H10.2221V2.5C10.2221 2.36739 10.1752 2.24021 10.0919 2.14645C10.0085 2.05268 9.89549 2 9.77762 2H6.22206C6.10419 2 5.99114 2.05268 5.90779 2.14645C5.82444 2.24021 5.77762 2.36739 5.77762 2.5V4H3.11095C2.99307 4 2.88003 4.05268 2.79668 4.14645C2.71333 4.24021 2.6665 4.36739 2.6665 4.5C2.6665 4.63261 2.71333 4.75979 2.79668 4.85355C2.88003 4.94732 2.99307 5 3.11095 5H12.8887C13.0066 5 13.1196 4.94732 13.203 4.85355C13.2863 4.75979 13.3332 4.63261 13.3332 4.5C13.3332 4.36739 13.2863 4.24021 13.203 4.14645C13.1196 4.05268 13.0066 4 12.8887 4ZM6.6665 3H9.33317V4H6.6665V3Z"})]})}var o=l(55559),d=l(2662),c=l(96120),u=l.n(c);function m(e){let{isOpen:t,handleClose:l,onSubmit:i,image:r,aspect:a}=e,c=(0,n.useRef)(null),[m,p]=(0,n.useState)({x:10,y:10,width:80,height:80,unit:"%"}),[x,h]=(0,n.useState)();return(0,s.jsxs)(o.Z,{isOpen:t,handleClose:l,children:[(0,s.jsx)(d.Z,{onCancel:l,title:"Crop Image",onSubmit:()=>i(x)}),(0,s.jsx)(u(),{ruleOfThirds:!0,crop:m,onChange:(e,t)=>p(t),onComplete:(e,t)=>h(t),aspect:a,children:(0,s.jsx)("img",{ref:c,alt:"Crop Image",src:r})})]})}l(96167);var p=l(78743),x=l(70154),h=l(22197),f=l(64487),v=l(9598),g=l(48228),j=l(22579);let w=async e=>{let{assetId:t}=e;if(!t)throw Error("assetId is required");let l=await fetch("/api/image/createVariations",{credentials:"include",method:"POST",body:JSON.stringify({assetId:t})});return l.json()},b=e=>{let{assetId:t,options:l,onSuccess:s}=e,i=(0,v.d)(),{incrementVisibleItems:r}=(0,j.Ei)(),{setIsCreating:n}=(0,j.RO)();return(0,g.D)({...l,mutationFn:()=>w({assetId:t}),mutationKey:["createVariations",t],onSuccess:e=>{n(!1),null==s||s(e),r(),(0,x.wf)(e)},onError:e=>{n(!1),i("Could not create variations of image","error"),(0,f.Tb)(e)}})};var N=l(85459),y=l(16841),C=l(92981),k=l(93162);let P=async e=>{try{e.startsWith("https://imagedelivery.net")||(e+=".jpeg");let t=await fetch(e,{headers:{Accept:"image/jpeg, image/png"}}),l=await t.blob();(0,k.saveAs)(l,(0,C.Mc)())}catch(s){console.log(s),window.open(e,"_blank")}};var I=l(11163),R=l(61121),M=l(52091),S=l(19042),_=l(7696),E=l(93181),z=l(3778),A=l(19151),T=l(12100),Z=l(72146);let O=e=>{var t;let{index:l,asset:r,prompt:o,onUpdate:d}=e,[c,u]=n.useState(!1),{setIsCreating:f,isCreating:g}=(0,j.RO)(),w=(0,I.useRouter)(),{applyReferenceImage:k,setReferenceImage:O}=(0,j.YN)(),D=(0,h.Y)("upscaleAndVariation"),{setIsOpen:U}=(0,y.Tf)(),L=(0,v.d)(),H=n.useRef(null),{setControlNetItems:F}=(0,j.Od)(),{setOutput:W}=(0,j.tW)(),{setCanvas:Y}=(0,j.$P)(),{setReferencePercentage:V}=(0,j.No)(),{setImageCount:K}=(0,j.ZT)(),{setQueuePosition:q}=(0,j.Qs)(),B=n.useMemo(()=>{var e;return(null===(e=o.provider)||void 0===e?void 0:e.name)==="Stable Diffusion XL"},[null===(t=o.provider)||void 0===t?void 0:t.name]),J=()=>{f(!1)},{mutate:$}=(0,N.X)({assetId:r.id,onSuccess:J}),{mutate:G}=b({assetId:r.id,onSuccess:J}),Q=(0,j.N9)(),X=e=>{(0,x.he)({id:o.id,assets:e})},ee=e=>{let t=o.assets;X(t.filter(t=>t.id!==e)),eo()},et=e=>{if(!D){U(!0,"upscale");return}f(!0),q({position:1,totalTimeEstimate:20}),w.pathname.includes("create")||w.pathname.includes("feed")?w.asPath&&w.asPath.includes("prompt")&&w.push(w.pathname):w.push("/create"),$(),window.scrollTo(0,0),e.stopPropagation(),eo()},el=async e=>{e.stopPropagation();let t=await fetch("/api/asset/".concat(r.id,"/isolate")).then(e=>e.json());(0,x.wf)(t);let l=o.assets;X(l.filter(e=>e.id!==r.id)),L("Success"),w.asPath.includes("create")||w.push("/prompt/".concat(t.post.data.id)),eo()},es=e=>{if(!D){U(!0,"variation");return}f(!0),w.pathname.includes("create")||w.pathname.includes("feed")?w.asPath&&w.asPath.includes("prompt")&&w.push(w.pathname):w.push("/create"),G(),window.scrollTo(0,0),e.stopPropagation(),eo()},ei=e=>{e.stopPropagation(),u(!0),eo()},er=e=>{e.stopPropagation(),P(r.cfUrl||r.src),eo()},en=e=>{e.stopPropagation();let t=o.assets,l=null;1===t.length&&(l=setTimeout(()=>{(0,x.b_)(o.id)},1e4)),Q(r,()=>{l&&(clearTimeout(l),l=null),X(t)}),ee(r.id),eo()},ea=e=>{e.stopPropagation(),O(void 0),k(r.cfUrl||r.src),w.asPath.includes("create")||w.push("/create?promptId="+o.id+"&skipRef=true&page=general"),eo()},eo=()=>{var e;null===(e=H.current)||void 0===e||e.click()},ed=async e=>{e.stopPropagation(),O(void 0);let t=await (0,j.n$)(r.cfUrl||r.src),l=o.meta;K(1);let s=(0,Z.G)(l.width,l.height);W(s.output),Y(s.canvas),V(100),W("large"),F([{enabled:!0,id:(0,C.Mc)(),image:t,isControlNetOutput:!1,maskImage:void 0,model:"none",settings:{controlnet_conditioning_scale:.8,detection_resolution:512,canny_low_threshold:100,canny_high_threshold:200,mlsd_thr_v:.1,mlsd_thr_d:.1}},{enabled:!0,id:(0,C.Mc)(),image:t,isControlNetOutput:!1,maskImage:void 0,model:"tile",settings:{controlnet_conditioning_scale:.4,detection_resolution:512,canny_low_threshold:100,canny_high_threshold:200,mlsd_thr_v:.1,mlsd_thr_d:.1}}]),w.push("/create?promptId="+o.id+"&skipRef=true&page=general&autoCreate=true&skipCN=true"),eo()},ec=async e=>{e.stopPropagation(),O(void 0);let t=await (0,j.n$)(r.cfUrl||r.src);K(1),W("large"),F([{enabled:!0,id:(0,C.Mc)(),image:t,isControlNetOutput:!1,maskImage:void 0,model:"tile",settings:{controlnet_conditioning_scale:.2,detection_resolution:512,canny_low_threshold:100,canny_high_threshold:200,mlsd_thr_v:.1,mlsd_thr_d:.1}}]),w.push("/create?promptId="+o.id+"&skipRef=true&page=general&autoCreate=true&skipCN=true"),eo()},eu=()=>{let e=document.createElement("textarea");e.value=r.src,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),L("Image URL copied to clipboard!")};return(0,s.jsxs)("div",{className:"z-30 lg:invisible group-hover:visible absolute top-2 right-2 text-center w-fit h-fit md:flex flex-col justify-center items-center gap-1",children:[(0,s.jsx)("div",{className:"",children:(0,s.jsxs)(z.J2,{children:[(0,s.jsx)(z.xo,{children:(0,s.jsx)(i.Z,{rounded:!0,size:"icon",variant:"secondary",children:(0,s.jsx)(_.yjk,{size:16})})}),(0,s.jsxs)(z.yk,{align:"end",className:"",children:[o.assets.length>1&&(0,s.jsxs)(p.m,{onClick:el,icon:(0,s.jsx)(R.Zw4,{size:16}),children:["Post image separately"," "]}),(0,s.jsx)(p.m,{disabled:g||B,onClick:ed,icon:(0,s.jsx)(A.Hcu,{size:16}),children:"Boost details"}),(0,s.jsx)(p.m,{disabled:g||B,onClick:ec,icon:(0,s.jsx)(S.NNQ,{size:16}),children:"Magic enhancer"}),(0,s.jsx)(p.m,{disabled:g,onClick:et,icon:(0,s.jsx)(M.U9w,{size:16}),children:"Upscale"}),(0,s.jsx)("div",{className:"hidden",children:(0,s.jsx)(p.m,{disabled:!0,onClick:es,icon:(0,s.jsx)(T.Z,{size:16}),children:"Create variations"})}),(0,s.jsx)(p.m,{onClick:ea,icon:(0,s.jsx)(E.oNA,{size:16}),children:"Use as reference"}),(0,s.jsx)(p.m,{onClick:er,icon:(0,s.jsx)(S.H_7,{size:16}),children:"Download"}),(0,s.jsx)(p.m,{onClick:eu,icon:(0,s.jsx)(R.BNl,{size:16}),children:"Copy image URL"}),(0,s.jsx)(p.m,{onClick:ei,icon:(0,s.jsx)(R.GZo,{size:16}),children:"Crop"}),(0,s.jsx)(p.m,{onClick:en,icon:(0,s.jsx)(a,{size:16,className:"!fill-foreground"}),children:"Delete"}),(0,s.jsx)(z.xp,{ref:H})]})]})}),c&&(0,s.jsx)(m,{image:r.cfUrl||r.src,isOpen:!!c,aspect:r.width/r.height,handleClose:()=>u(!1),onSubmit:async e=>{let t=await fetch("/api/prompt/".concat(o.id),{method:"PATCH",body:JSON.stringify({crop:e,assetId:r.id}),headers:{"Content-Type":"application/json"}}),s=await t.json();(0,x.he)({id:o.id,assets:o.assets.map((e,t)=>({...t===l?{...e,cfUrl:s.cfUrl}:e,promptId:o.id,color:""}))}),null==d||d({...r,cfUrl:s.cfUrl}),u(!1)}})]})}},12100:function(e,t,l){l.d(t,{Z:function(){return i}});var s=l(85893);function i(e){let{size:t=24,className:l}=e;return(0,s.jsxs)("svg",{width:t,height:t,viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",className:l,children:[(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.00098 0C4.89641 0 4.00098 0.895431 4.00098 2V14C4.00098 15.1046 4.89641 16 6.00098 16H18.001C19.1055 16 20.001 15.1046 20.001 14V2C20.001 0.895431 19.1055 0 18.001 0H6.00098ZM10.6388 4.31885C10.6388 5.04723 10.0484 5.6377 9.32 5.6377C8.59162 5.6377 8.00115 5.04723 8.00115 4.31885C8.00115 3.59047 8.59162 3 9.32 3C10.0484 3 10.6388 3.59047 10.6388 4.31885ZM17.0304 13.2498H7.03287C6.09661 13.2498 5.48546 12.2672 5.89939 11.4274L7.11368 8.96388C7.51601 8.14762 8.62321 8.0114 9.2114 8.7058L9.49515 9.04078C10.0447 9.6895 11.0651 9.62145 11.5236 8.90552L13.4706 5.86528C14.0097 5.0235 15.2664 5.11126 15.6833 6.0198L18.179 11.4592C18.5631 12.2962 17.9514 13.2498 17.0304 13.2498Z"}),(0,s.jsx)("path",{d:"M8.00098 23C8.00098 22.4477 8.44869 22 9.00098 22H15.001C15.5533 22 16.001 22.4477 16.001 23C16.001 23.5523 15.5533 24 15.001 24H9.00098C8.44869 24 8.00098 23.5523 8.00098 23Z"}),(0,s.jsx)("path",{d:"M6.00098 19C6.00098 18.4477 6.44869 18 7.00098 18H17.001C17.5533 18 18.001 18.4477 18.001 19C18.001 19.5523 17.5533 20 17.001 20H7.00098C6.44869 20 6.00098 19.5523 6.00098 19Z"})]})}l(67294)},2662:function(e,t,l){l.d(t,{Z:function(){return r}});var s=l(85893);l(67294);var i=l(47340);function r(e){let{title:t,onSubmit:l,onCancel:r}=e;return(0,s.jsxs)("div",{className:"flex justify-between p-6 items-center w-full bg-background z-50",children:[(0,s.jsx)("div",{children:(0,s.jsx)(i.Z,{variant:"tertiary",size:"small",onClick:r,children:"Cancel"})}),(0,s.jsx)("div",{children:t}),(0,s.jsx)("div",{children:(0,s.jsx)(i.Z,{variant:"accent",size:"small",onClick:l,children:"Done"})})]})}},17702:function(e,t,l){var s=l(85893),i=l(67294),r=l(94991),n=l(18318),a=l(47340),o=l(43633),d=l(78743);let c=e=>{let{prompt:t,children:l,iconSize:c=20,withTooltip:u,isMenuItem:m,onDone:p,...x}=e,{copy:h}=(0,r.FU)(),f=(0,r.d$)(),v=(0,i.useCallback)(async e=>{e.nativeEvent.stopImmediatePropagation(),e.preventDefault(),e.stopPropagation(),h(t.replace(/,\s*$/,"")),f("Prompt copied to clipboard!"),null==p||p()},[h,t,f,p]),g="Copy prompt";return(0,s.jsx)(s.Fragment,{children:m?(0,s.jsx)(d.m,{onClick:e=>v(e),icon:(0,s.jsx)(n.On2,{size:c}),children:g}):(0,s.jsx)(o.d,{withTooltip:u,content:g,children:(0,s.jsxs)(a.Z,{onClick:v,...x,children:[(0,s.jsx)(n.On2,{size:c}),l]})})})};t.Z=c},43633:function(e,t,l){l.d(t,{d:function(){return F},x:function(){return H}});var s=l(85893),i=l(67294),r=l(26107),n=l(94991),a=l(36492);let o=async e=>{let t=await fetch("/api/prompt/".concat(e,"/isArchived"),{credentials:"include",method:"GET",headers:{"Content-Type":"application/json"}});return t.json()},d=["isArchived"],c=e=>{let{promptId:t,options:l}=e;return(0,a.a)([...d,t],()=>o(t),{...l,staleTime:1/0})};var u=l(24092),m=l(48228);async function p(e,t){let l=await fetch("".concat((0,u.f)(),"/prompt/").concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isArchived:t})}),s=await l.json();return s[0]}let x=e=>{let{promptId:t,isArchived:l,options:s}=e;return(0,m.D)(()=>p(t,l),{...s,mutationKey:["togglePromptVisibility",t,l]})};var h=l(9598),f=l(85945),v=l(7696),g=l(70154),j=l(78743),w=l(4819);let b=e=>{let{withTooltip:t,isCurrentlyArchived:l,onClick:i,onSuccessfulArchive:r,promptId:n,...a}=e,o=(0,f.NL)(),u=(0,h.d)(),{data:m}=c({promptId:n,options:{initialData:{isArchived:l}}}),p=!(null==m?void 0:m.isArchived),{mutate:b,isLoading:N}=x({isArchived:p,promptId:n,options:{onSuccess:async()=>{p?u("Post archived!"):u("Post unarchived!"),o.setQueryData([...d,n],{isArchived:p}),o.setQueriesData({predicate:e=>{let{queryKey:t}=e;return t[0]===g.Db[0]}},e=>{if(!e)return e;let t=e.pages.reduce((e,t)=>{let l=t.feedItems.find(e=>e.post.data.id===n);return l?[...e,{...t,feedItems:t.feedItems.filter(e=>e.post.data.id!==n)}]:[...e,t]},[]);return{...e,pages:t}}),null==r||r()},onError:()=>{u("Something went wrong","error")}}});return a.isMenuItem?(0,s.jsx)(j.m,{onClick:()=>{b(),null==i||i()},icon:(null==m?void 0:m.isArchived)?(0,s.jsx)(v.z2M,{className:"text-foreground",size:16}):(0,s.jsx)(v.tlU,{className:"text-foreground",size:16}),children:(null==m?void 0:m.isArchived)?"Unarchive":"Archive"}):(0,s.jsx)(F,{withTooltip:t,content:(null==m?void 0:m.isArchived)?"Unarchive":"Archive",children:(0,s.jsx)(w.z,{variant:"ghost",onClick:()=>{b(),null==i||i()},disabled:N,children:(null==m?void 0:m.isArchived)?(0,s.jsx)(v.z2M,{size:20}):(0,s.jsx)(v.tlU,{size:20})})})};var N=l(33268),y=l(52091),C=l(16841),k=l(97998),P=l(67394),I=l(70406),R=l(86010);let M=e=>{let{initialData:t,promptId:l,className:r,iconSize:a=16,withTooltip:o,onLikedChange:d,noBorder:c,likedClassName:u,unlikedClassName:m}=e,{isLoggedIn:p}=(0,n.kP)(),x=(0,n.d$)(),h=(0,f.NL)(),{data:v}=(0,k.C)({promptId:l,options:{initialData:t}}),g=!!(null==v?void 0:v.isLiked),j=(null==v?void 0:v.likesCount)||0,b=(0,i.useCallback)((e,t)=>{h.setQueryData([...k.E,l],{isLiked:e,likesCount:t})},[l,h]),N=(0,i.useCallback)(()=>{b(g,j)},[j,g,b]),M=(0,P.o)({promptId:l,options:{onError:()=>{N(),x("Could not like","error")}}}),S=(0,I.o)({promptId:l,options:{onError:()=>{N(),x("Could not remove like","error")}}}),{isLiked:_}=v||{},{setIsLogInModalOpen:E}=(0,C.l9)(),z=async e=>{if(e.stopPropagation(),e.preventDefault(),e.nativeEvent.stopImmediatePropagation(),!p)return E(!0);b(!g,j+(g?-1:1)),_?(S.mutate(),null==d||d(!1)):(M.mutate(),null==d||d(!0))};return(0,s.jsx)(F,{withTooltip:o,content:"Like",children:(0,s.jsx)(w.z,{onClick:z,variant:"ghost",className:(0,R.Z)(_?u:m,!_&&c&&"",r),children:_?(0,s.jsx)(y.$0H,{size:a,className:"text-[#F91880]"}):(0,s.jsx)(y.BgW,{size:a})})})};var S=l(17702),_=l(4886),E=l(11163);let z=e=>{let{promptId:t,withTooltip:l,disabled:r}=e,{push:a}=(0,E.useRouter)(),{isLoggedIn:o}=(0,n.kP)(),{setIsLogInModalOpen:d}=(0,C.l9)(),c=(0,i.useCallback)(()=>{if(!o){d(!0);return}a("/create?promptId="+t+"&stylesTab=styles")},[o,a,t,d]);return(0,s.jsx)(F,{withTooltip:l,content:"Reuse",children:(0,s.jsx)(w.z,{variant:"ghost",onClick:c,disabled:r,children:(0,s.jsx)(_.Z,{name:"recreate",size:20})})})};var A=l(50933),T=l(97349);async function Z(e,t){let l=await fetch("".concat((0,u.f)(),"/prompt/").concat(e,"/toggleIsRestricted"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({isRestricted:t})});return l.json()}let O=e=>{let{promptId:t,isRestricted:l,options:s}=e;return(0,m.D)(()=>Z(t,l),{...s,mutationKey:["toggleIsRestricted",t,l]})},D=e=>{let{withTooltip:t,onClick:l,promptId:r,initialData:n,...a}=e,o=(0,C.Wg)(),[d,c]=(0,i.useState)(!1),u=(0,f.NL)(),m=(0,h.d)(),{data:p}=(0,A.G)({promptId:r,options:{initialData:n}}),x=(0,i.useCallback)(e=>{u.setQueryData([...A.I,r],{isRestricted:e})},[r,u]),v=!(null==p?void 0:p.isRestricted),{mutate:g}=O({isRestricted:v,promptId:r,options:{onSuccess:async()=>{v?m("Prompt details hidden!"):m("Prompt details published!"),u.invalidateQueries({predicate:e=>{let{queryKey:t}=e,l=t[0]===T.$j[0]&&t.includes(r);return l}})},onError:()=>{x(!v),m("Something went wrong","error")}}}),b="lockUnlocked";return(b=(null==p?void 0:p.isRestricted)?d?"lockUnlocked":"lockLocked":d?"lockLocked":"lockUnlocked",a.isMenuItem)?(0,s.jsx)(j.m,{onClick:()=>{x(v),g(),null==l||l()},icon:(0,s.jsx)(_.Z,{size:16,name:b,className:"text-foreground"}),children:(null==p?void 0:p.isRestricted)?"Show prompt":"Hide prompt"}):(0,s.jsx)(F,{withTooltip:t,content:(null==p?void 0:p.isRestricted)?"Show prompt":"Hide prompt",children:(0,s.jsx)(w.z,{size:"sm",variant:"ghost",...a,onClick:()=>{x(v),g(),null==l||l()},onMouseEnter:()=>{c(!0),o(r)},onMouseLeave:()=>{c(!1),o(null)},children:(0,s.jsx)(_.Z,{size:20,name:b})})})},U={[N.a.LIKE]:{show:!0,args:null},[N.a.COPY]:{show:!0,args:null},[N.a.REUSE]:{show:!0,args:null},[N.a.RESTRICT]:{show:!0,args:null},[N.a.ARCHIVE]:{show:!0,args:null},[N.a.COPY_WORKFLOW]:{show:!0,args:null}},L=(e,t)=>Object.keys(e).reduce((l,s)=>{let i=e[s];return(null==i?void 0:i.show)&&N.v.includes(s)&&!t?l[s]={...i,show:!1}:l[s]=i,l},{}),H=e=>{var t;let{prompt:l,actionsConfig:r=U,moreActionsConfig:a,withTooltip:o}=e,d=(0,n.rY)({promptUserId:(null===(t=l.user)||void 0===t?void 0:t.id)||"",skipAdminCheck:!0}),{user:c}=(0,n.kP)(),u=(0,i.useMemo)(()=>({...U,...r}),[r]),m=(0,i.useMemo)(()=>L(u,d),[d,u]),p=(0,i.useMemo)(()=>a?L(a,d||!!(null==c?void 0:c.isAdmin)):null,[d,a,null==c?void 0:c.isAdmin]),x=(0,i.useCallback)(e=>!(null==l?void 0:l.isArchived)&&(null==e?void 0:e.show)?(0,s.jsx)(M,{noBorder:!0,initialData:{isLiked:l.liked,likesCount:l.likeCount},withTooltip:o,onLikedChange:()=>{var t;return null===(t=e.onClick)||void 0===t?void 0:t.call(e,{promptId:l.id})},promptId:l.id,className:""}):null,[l.id,null==l?void 0:l.isArchived,l.likeCount,l.liked,o]),h=(0,i.useCallback)(e=>(null==e?void 0:e.show)?(0,s.jsx)(S.Z,{disabled:!l.prompt,withTooltip:o,className:"border-0",variant:"ghost",size:"small",resize:"fill",prompt:l.prompt||""}):null,[l.prompt,o]),f=(0,i.useCallback)(e=>(null==e?void 0:e.show)?(0,s.jsx)(z,{promptId:l.id,withTooltip:o,disabled:l.isRestricted&&!d}):null,[d,l.id,l.isRestricted,o]),v=(0,i.useCallback)(e=>(null==e?void 0:e.show)?(0,s.jsx)(b,{promptId:l.id,isCurrentlyArchived:l.isArchived,withTooltip:o,onClick:()=>{var t;return null===(t=e.onClick)||void 0===t?void 0:t.call(e,{promptId:l.id})},onSuccessfulArchive:()=>{var t;return null===(t=e.onSuccessfulAction)||void 0===t?void 0:t.call(e,{promptId:l.id})}}):null,[l.id,l.isArchived,o]),g=(0,i.useCallback)(e=>(null==e?void 0:e.show)?(0,s.jsx)(D,{initialData:{isRestricted:l.isRestricted},promptId:l.id,withTooltip:o,onClick:()=>{var t;return null===(t=e.onClick)||void 0===t?void 0:t.call(e,{promptId:l.id})}}):null,[l.id,l.isRestricted,o]),w=m[N.a.LIKE],y=m[N.a.COPY],C=m[N.a.REUSE],k=m[N.a.ARCHIVE],P=m[N.a.RESTRICT];return(0,s.jsxs)("div",{className:"w-full flex justify-evenly items-center mb-4",children:[m&&(0,s.jsxs)(s.Fragment,{children:[w&&(0,s.jsx)(x,{...w}),C&&(0,s.jsx)(f,{...C}),y&&(0,s.jsx)(h,{...y}),k&&(0,s.jsx)(v,{...k}),P&&(0,s.jsx)(g,{...P})]}),!!p&&(0,s.jsx)(j.Z,{prompt:l,actionsConfig:p})]})},F=e=>{let{withTooltip:t,content:l,children:i}=e;return(0,s.jsx)(s.Fragment,{children:t?(0,s.jsxs)(r.u,{children:[(0,s.jsx)(r.aJ,{children:i}),(0,s.jsx)(r._v,{children:l})]}):(0,s.jsx)(s.Fragment,{children:i})})}},78743:function(e,t,l){l.d(t,{m:function(){return E},Z:function(){return _}});var s=l(85893),i=l(67294),r=l(3778),n=l(78633),a=l(52091),o=l(94991),d=l(22579),c=l(47340),u=l(43575),m=l(11163),p=l(33268),x=l(17702),h=l(70154),f=l(36492);let v=async e=>{let t=await fetch("/api/prompt/".concat(e,"/isPrivate"),{credentials:"include",method:"GET",headers:{"Content-Type":"application/json"}});return t.json()},g=["isPrivate"],j=e=>{let{promptId:t,options:l}=e;return(0,f.a)([...g,t],()=>v(t),{...l,staleTime:1/0})};var w=l(24092),b=l(48228);async function N(e,t){let l=await fetch("".concat((0,w.f)(),"/prompt/").concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isPrivate:t})}),s=await l.json();return s[0]}let y=e=>{let{promptId:t,isPrivate:l,options:s}=e;return(0,b.D)(()=>N(t,l),{...s,mutationKey:["togglePromptPrivate",t,l]})};var C=l(85945),k=l(43633);let P=e=>{let{children:t,iconSize:l=20,withTooltip:r,isMenuItem:a,isCurrentlyPrivate:d,promptId:u,onDone:m,...p}=e,x=(0,o.d$)(),f=(0,C.NL)(),{data:v}=j({promptId:u,options:{initialData:{isPrivate:d}}}),w=!(null==v?void 0:v.isPrivate),b=(null==v?void 0:v.isPrivate)?"Make public":"Make private",{mutate:N}=y({isPrivate:w,promptId:u,options:{onSuccess:async()=>{w?x("Post made private!"):x("Post made public!"),f.setQueryData([...g,u],{isPrivate:w}),f.setQueriesData({predicate:e=>{let{queryKey:t}=e;return t[0]===h.Db[0]}},e=>{if(!e)return e;let t=e.pages.reduce((e,t)=>{let l=t.feedItems.find(e=>e.post.data.id===u);return l?[...e,{...t,feedItems:t.feedItems.map(e=>e.post.data.id===u?{...e,post:{...e.post,data:{...e.post.data,isPrivate:w}}}:e)}]:[...e,t]},[]);return{...e,pages:t}})},onError:()=>{x("Something went wrong","error")}}}),P=(0,i.useCallback)(async e=>{e.nativeEvent.stopImmediatePropagation(),e.preventDefault(),e.stopPropagation(),N(),null==m||m()},[N,m]),I=(null==v?void 0:v.isPrivate)?n.rCC:n.I$m;return(0,s.jsx)(s.Fragment,{children:a?(0,s.jsx)(E,{onClick:e=>P(e),icon:(0,s.jsx)(I,{size:l}),children:b}):(0,s.jsx)(k.d,{withTooltip:r,content:b,children:(0,s.jsxs)(c.Z,{onClick:P,...p,children:[(0,s.jsx)(I,{size:l}),t]})})})};var I=l(4819),R=l(77182),M=l(18318);let S=e=>{let{meta:t,onDownloadComplete:l}=e,{toast:r}=(0,R.pm)(),{user:n}=(0,o.kP)(),a=(0,i.useCallback)(()=>{let e="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(t.comfyWorkflow,null,2)),s=document.createElement("a");s.setAttribute("href",e),s.setAttribute("download","comfyWorkflow.json"),document.body.appendChild(s),s.click(),s.remove(),r({description:"ComfyWorkflow downloaded as JSON!",variant:"success"}),null==l||l()},[t,l,r]);return(null==n?void 0:n.isAdmin)?(0,s.jsxs)(I.z,{onClick:a,variant:"ghost",className:"shrink-0",children:[(0,s.jsx)(M.k$5,{className:"mr-2"}),"Download workflow"]}):null};function _(e){var t;let{prompt:l,actionsConfig:c}=e,{user:f}=(0,o.kP)(),v=(null==f?void 0:f.isAdmin)||!1,g=i.useMemo(()=>({...c,[p.a.COPY_WORKFLOW]:{...null==c?void 0:c[p.a.COPY_WORKFLOW],show:v}}),[c,v]),j=(0,o.rY)({promptUserId:(null===(t=l.user)||void 0===t?void 0:t.id)||""}),[w,b]=i.useState(!1),N=(0,d.iJ)(),y=(0,d.n0)(),C=(0,m.useRouter)(),k=i.useMemo(()=>{var e;return null!==(e=null==l?void 0:l.isArchived)&&void 0!==e&&e},[l]),R=i.useRef(null),M=i.useCallback(()=>{var e;null===(e=R.current)||void 0===e||e.click()},[]),_=i.useCallback(()=>{j&&y({id:l.id,isArchived:!k}),M()},[j,M,y,l.id,k]),z=C.asPath,A=i.useCallback(()=>{var e;return(null==c?void 0:null===(e=c.delete)||void 0===e?void 0:e.show)?(0,s.jsx)(u.Z,{title:"Delete Prompt?",description:"This can’t be undone and it will be removed from your profile and search.",isOpen:w,setIsOpen:b,buttons:[{text:"Delete",onClick:async()=>{var e,t;N(l.id),null==c||null===(e=c.delete)||void 0===e||null===(t=e.onClick)||void 0===t||t.call(e,{promptId:l.id}),(0,h.b_)(l.id),b(!1),z.includes("create")||C.push("/profile")}},{text:k?"Unarchive":"Archive",variant:"tertiary",onClick:()=>_()},{text:"Cancel",variant:"tertiary",onClick:()=>b(!1)}]}):null},[z,N,w,k,_,l.id,C,c]),T=i.useCallback(()=>{var e;return(null==c?void 0:null===(e=c.delete)||void 0===e?void 0:e.show)?(0,s.jsx)(E,{type:"danger",onClick:()=>b(!0),icon:(0,s.jsx)(a.Xm5,{size:16}),children:"Delete Prompt"}):null},[c]),Z=i.useCallback(()=>{var e;return(null==c?void 0:null===(e=c.copy)||void 0===e?void 0:e.show)&&l.prompt?(0,s.jsx)(x.Z,{onDone:()=>M(),prompt:l.prompt,isMenuItem:!0,iconSize:16}):null},[c,l,M]),O=i.useCallback(()=>{var e;return(null==c?void 0:null===(e=c.private)||void 0===e?void 0:e.show)?(0,s.jsx)(P,{onDone:()=>M(),promptId:l.id,isCurrentlyPrivate:l.isPrivate,isMenuItem:!0,iconSize:16}):null},[c,l.id,l.isPrivate,M]),D=i.useCallback(()=>{var e;return(null===(e=g[p.a.COPY_WORKFLOW])||void 0===e?void 0:e.show)?(0,s.jsx)(S,{meta:l.meta}):null},[g,l.meta]),U=c&&Object.values(c).some(e=>null==e?void 0:e.show);return U?(0,s.jsxs)(s.Fragment,{children:[A(),(0,s.jsx)("div",{children:(0,s.jsxs)(r.J2,{children:[(0,s.jsx)(r.xo,{asChild:!0,children:(0,s.jsx)(I.z,{variant:"ghost",children:(0,s.jsx)(n.evw,{})})}),(0,s.jsxs)(r.yk,{side:"top",children:[Z(),D(),O(),T()]}),(0,s.jsx)(r.xp,{ref:R})]})})]}):null}let E=e=>{let{children:t,...l}=e;return(0,s.jsxs)(c.Z,{disabled:l.disabled,onClick:l.onClick,className:"items-start text-left !justify-start text-[14px] lg:text-xs py-[22px] lg:py-2",variant:"ghost",size:"small",children:[l.icon,t]})}},33268:function(e,t,l){l.d(t,{a:function(){return s},v:function(){return i}});let s={LIKE:"like",COPY:"copy",REUSE:"reuse",DOWNLOAD:"download",RESTRICT:"restrict",ARCHIVE:"archive",DELETE:"delete",UPSCALE:"upscale",PRIVATE:"private",COPY_WORKFLOW:"copyWorkflow"},i=[s.RESTRICT,s.ARCHIVE,s.DELETE,s.UPSCALE,s.PRIVATE]},26107:function(e,t,l){l.d(t,{_v:function(){return h},aJ:function(){return x},u:function(){return p}});var s=l(85893),i=l(67294),r=l(76530),n=l(37899),a=l(63679),o=l(88301),d=l(65820),c=l(63387);let u=i.createContext(null),m=()=>{let e=i.useContext(u);if(null==e)throw Error("Tooltip components must be wrapped in <Tooltip />");return e};function p(e){let{children:t,...l}=e,r=function(){let{initialOpen:e=!1,placement:t="top",defaultOffset:l,open:s,onOpenChange:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[d,c]=i.useState(e),u={mainAxis:5,crossAxis:0,...l},m=null!=s?s:d,p=null!=r?r:c,x=(0,n.YF)({placement:t,open:m,onOpenChange:p,whileElementsMounted:a.Me,middleware:[(0,o.cv)(u),(0,a.RR)(),(0,a.uY)()]}),h=x.context,f=(0,n.XI)(h,{move:!1,enabled:null==s,handleClose:(0,n.xp)()}),v=(0,n.KK)(h,{enabled:null==s}),g=(0,n.bQ)(h),j=(0,n.qs)(h,{role:"tooltip"}),w=(0,n.NI)([f,v,g,j]);return i.useMemo(()=>({open:m,setOpen:p,...w,...x}),[m,p,w,x])}(l);return(0,s.jsx)(u.Provider,{value:r,children:t})}let x=i.forwardRef(function(e,t){let{children:l,asChild:n=!1,...a}=e,o=m(),d=null==l?void 0:l.ref,c=i.useMemo(()=>(0,r.l)([o.reference,t,d]),[o.reference,t,d]);return n&&i.isValidElement(l)?i.cloneElement(l,o.getReferenceProps({ref:c,...a,...l.props,"data-state":o.open?"open":"closed"})):(0,s.jsx)("div",{ref:c,"data-state":o.open?"open":"closed",...o.getReferenceProps(a),children:l})}),h=i.forwardRef(function(e,t){var l,a,o,u;let p=m(),x=i.useMemo(()=>(0,r.l)([p.floating,t]),[p.floating,t]),{className:h,...f}=p.getFloatingProps(e);return(0,s.jsx)(n.ll,{children:(0,s.jsx)(d.M,{children:p.open&&(0,s.jsx)(c.E.div,{ref:x,className:h||"px-6 py-4 bg-popover text-popover-foreground font-medium rounded-lg border-border border shadow-[0_3px_10px_rgb(0,0,0,0.2)]",initial:{opacity:0,scale:1},animate:{opacity:1,scale:1,transition:{duration:.5,delay:0}},exit:{opacity:0,scale:1},style:{position:p.strategy,top:p.y&&(null==e?void 0:null===(l=e.insets)||void 0===l?void 0:l.top)?p.y+(null==e?void 0:null===(a=e.insets)||void 0===a?void 0:a.top):p.y?p.y:0,left:p.x&&(null==e?void 0:null===(o=e.insets)||void 0===o?void 0:o.left)?p.x+(null==e?void 0:null===(u=e.insets)||void 0===u?void 0:u.left):p.x?p.x:0,visibility:null==p.x?"hidden":"visible",zIndex:9999,...e.style},...f})})})})},50933:function(e,t,l){l.d(t,{G:function(){return n},I:function(){return r}});var s=l(36492);let i=async e=>{let t=await fetch("/api/prompt/".concat(e,"/isRestricted"),{credentials:"include",method:"GET",headers:{"Content-Type":"application/json"}});return t.json()},r=["isRestricted"],n=e=>{let{promptId:t,options:l}=e;return(0,s.a)([...r,t],()=>i(t),{...l,staleTime:1/0})}},37811:function(e,t,l){l.r(t),l.d(t,{__N_SSP:function(){return eN},default:function(){return ey}});var s=l(85893),i=l(55300),r=l(79627),n=l(97349),a=l(4886),o=l(91254),d=l(41695),c=l(69031),u=l(65820),m=l(2962),p=l(9008),x=l.n(p),h=l(25675),f=l.n(h),v=l(41664),g=l.n(v),j=l(11163),w=l.n(j),b=l(67294),N=l(52091),y=l(84849),C=l(95062),k=l(77378),P=l(22579);let I=e=>{let{referenceImage:t,referenceMode:l,strength:i}=e,r=function(e){if(!e)return"Normal";let t=e.controlNetModel?"ControlNet - ".concat(e.controlNetModel):"Normal";return t}(l);return(0,s.jsxs)("div",{className:"flex gap-3 text-xs w-full items-center",children:[(0,s.jsx)("div",{className:"w-[100px] h-[100px]",children:(0,s.jsx)("a",{target:"_blank",href:t,rel:"noreferrer",className:"flex w-[100px] h-[100px] rounded-lg aspect-square overflow-hidden cursor-zoom-in",children:(0,s.jsx)("img",{src:t,alt:"Reference",className:"border-transparent bg-neutral-700 object-cover w-full object-center hover:opacity-80 hover:scale-110 transform transition duration-500"})})}),(0,s.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,s.jsxs)("div",{className:"flex flex-col justify-center items-start w-full grow shrink relative gap-0",children:[(0,s.jsx)("p",{className:"text-muted-foreground text-[10px] font-medium uppercase tracking-widest flex",children:"Mode"}),(0,s.jsx)("p",{className:"text-left text-[#8042E4] dark:text-purple-300 font-mono",children:r})]}),void 0!==i&&(0,s.jsxs)("div",{className:"flex flex-col justify-center items-start w-full grow shrink relative gap-0",children:[(0,s.jsx)("p",{className:"text-muted-foreground text-[10px] font-medium uppercase tracking-widest flex",children:"Image strength"}),(0,s.jsxs)("p",{className:"text-left dark:text-emerald-200 text-emerald-700 font-mono",children:[i,"%"]})]})]})]})};var R=l(93181);let M=e=>{let{controlNetImage:t,controlNetModel:l,strength:i}=e;return(0,s.jsxs)("div",{className:"flex gap-3 text-xs w-full items-center",children:[(0,s.jsx)("div",{className:"w-[100px] h-[100px]",children:(0,s.jsx)("a",{target:"_blank",href:t,rel:"noreferrer",className:"flex w-[100px] h-[100px] rounded-lg aspect-square overflow-hidden cursor-zoom-in",children:(0,s.jsx)("img",{src:t,alt:"Reference",className:"border-transparent bg-neutral-700 object-cover w-full object-center hover:opacity-80 hover:scale-110 transform transition duration-500"})})}),(0,s.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,s.jsxs)("div",{className:"flex flex-col justify-center items-start w-full grow shrink relative gap-0 ",children:[(0,s.jsx)("p",{className:"text-muted-foreground text-[10px] font-medium uppercase tracking-widest flex",children:"Mode"}),(0,s.jsx)("p",{className:"text-left text-[#8042E4] dark:text-purple-300 font-mono",children:l})]}),(0,s.jsxs)("div",{className:"flex flex-col justify-center items-start w-full grow shrink relative gap-0 ",children:[(0,s.jsx)("p",{className:"text-muted-foreground text-[10px] font-medium uppercase tracking-widest flex",children:"Strength"}),(0,s.jsxs)("p",{className:"text-left text-[#8042E4] dark:text-purple-300 font-mono",children:[i,"%"]})]})]})]})};var S=l(42397),_=l(4819);let E=e=>{var t;let{meta:l,width:i,height:r,name:n,selectedAssetUrl:a}=e,o=b.useMemo(()=>{let e=null==a?void 0:a.split("_").pop();return e?isNaN(parseInt(e))?0:parseInt(e)-1:0},[a]),{applyReferenceImage:d}=(0,P.YN)(),c=e=>{(null==l?void 0:l.referenceImage)&&(e.stopPropagation(),d(null==l?void 0:l.referenceImage),w().push("/create"))},u=b.useMemo(()=>{if(null==l?void 0:l.engine)return(null==l?void 0:l.engine)==="stable-diffusion-v1-5"?"PhChroma2"===l.model?"PhChroma 2":"PhChroma3"===l.model?"PhChroma 3":"Stable Diffusion 1.5":"stable-diffusion-xl"===l.engine?"Stable Diffusion XL":"Stable Diffusion 2.1"},[null==l?void 0:l.model,null==l?void 0:l.engine]);return(0,s.jsxs)(s.Fragment,{children:[(null==l?void 0:l.referenceImage)&&(0,s.jsxs)(S.Zb,{children:[(0,s.jsx)(S.Ol,{children:(0,s.jsxs)(S.ll,{className:"text-sm leading-5 font-medium flex justify-between items-center",children:[(0,s.jsx)("span",{children:"Reference Image"}),(0,s.jsxs)(_.z,{onClick:c,size:"sm",variant:"secondary",className:"h-fit py-1 text-xs",children:["Reuse ",(0,s.jsx)(R.KRP,{size:16,className:"ml-1"})]})]})}),(0,s.jsx)(S.aY,{children:(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"flex flex-col gap-4",children:(0,s.jsx)("div",{className:"text-left ",children:" "})}),(0,s.jsx)(I,{referenceImage:l.referenceImage,referenceMode:{controlNetModel:l.controlNetModel},strength:l.promptStrength})]})})]}),null==l?void 0:null===(t=l.controlNetItems)||void 0===t?void 0:t.filter(e=>Boolean(e.outputImage)).map((e,t)=>{var i;let r=(null==e?void 0:null===(i=e.settings)||void 0===i?void 0:i.controlnet_conditioning_scale)||1;return(0,s.jsx)(S.Zb,{children:(0,s.jsxs)(S.aY,{className:"flex flex-col gap-4 text-xs pt-6",children:[(0,s.jsx)("div",{className:"flex flex-col gap-4",children:(0,s.jsx)("div",{className:"flex justify-between text-sm font-medium text-left ",children:(0,s.jsx)("div",{className:"leading-5 w-full",children:"ControlNet"})})}),(0,s.jsx)(M,{controlNetImage:e.outputImage,controlNetModel:e.model||l.controlNetModel,strength:100*r})]})},t)}),(0,s.jsx)(S.Zb,{children:(0,s.jsxs)(S.aY,{className:"flex flex-col gap-4 text-xs pt-6",children:[u&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-muted-foreground text-[10px] font-medium uppercase tracking-widest flex",children:"Model"}),(0,s.jsx)("div",{className:"font-mono text-[#8042E4] dark:text-purple-300 line-clamp-1 text-md flex mb-1",children:(null==l?void 0:l.model)||n})]}),(null==l?void 0:l.cfg_scale)&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-muted-foreground text-[10px] font-medium uppercase tracking-widest flex",children:"Guidance"}),(0,s.jsx)("div",{className:"font-mono dark:text-emerald-200 text-emerald-700 text-md flex mb-1",children:null==l?void 0:l.cfg_scale})]}),i&&r&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-muted-foreground text-[10px] font-medium uppercase tracking-widest flex",children:"Dimensions"}),(0,s.jsxs)("div",{className:"font-mono dark:text-emerald-200 text-emerald-700 text-md flex",children:[i," x ",r]})]}),(null==l?void 0:l.sampler)&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-muted-foreground text-[10px] font-medium uppercase tracking-widest flex",children:"Sampler"}),(0,s.jsx)("div",{className:"font-mono text-[#8042E4] dark:text-purple-300 line-clamp-1 text-md flex mb-1",children:null==l?void 0:l.sampler})]}),(null==l?void 0:l.seed)&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-muted-foreground text-[10px] font-medium uppercase tracking-widest flex",children:"Seed"}),(0,s.jsx)("div",{className:"font-mono dark:text-emerald-200 text-emerald-700 text-md flex mb-1",children:l.seed+o})]}),(null==l?void 0:l.steps)&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-muted-foreground text-[10px] font-medium uppercase tracking-widest flex",children:"Steps"}),(0,s.jsx)("div",{className:"font-mono dark:text-emerald-200 text-emerald-700 text-md flex mb-1",children:null==l?void 0:l.steps})]})]})})]})};var z=l(86010),A=l(61121),T=l(78633),Z=l(2777),O=l(26107);function D(e){return e?e.charAt(0).toUpperCase()+e.slice(1):""}let U=e=>{let{Icon:t,text:l,colorClassName:i,isNegative:r}=e,n=l?l.replaceAll(" ","+"):"";return(0,s.jsxs)(O.u,{placement:"top-start",children:[(0,s.jsx)(O.aJ,{children:(0,s.jsxs)("div",{className:"group flex flex-row items-center p-0 gap-2 w-full px-6 py-2 content-between lg:hover:ring-[1px] ring-inset lg:hover:ring-blue-500 hover:cursor-default",children:[(0,s.jsxs)("div",{className:"w-full flex flex-row items-center p-0 gap-2",children:[(0,s.jsx)("div",{className:"w-4 h-4",children:(0,s.jsx)(t,{className:i,size:16})}),(0,s.jsx)("div",{className:"flex flex-col items-start p-0",children:(0,s.jsx)("span",{className:(0,z.Z)("text-xs leading-5 font-normal w-full line-clamp-1",i),children:D(l)})})]}),(0,s.jsx)("div",{className:"w-fit items-center ",children:!r&&(0,s.jsx)(g(),{target:"_blank",href:"/search?q=".concat(n),className:"hover:bg-white/20 p-1 items-center justify-center rounded-md mb-0 pb-0 relative top-[2px] right-0",children:(0,s.jsx)("button",{className:"h-4 w-4",children:(0,s.jsx)("span",{className:"search-icon opacity-0 group-hover:opacity-100 items-center justify-center ",children:(0,s.jsx)(R.lnn,{name:"chevron-right",size:14})})})})})]})}),(0,s.jsx)(O._v,{children:(0,s.jsx)("div",{className:"text-[10px] max-w-[260px]",children:D(l)})})]},l)},L=e=>{let{styles:t,isNegative:l,prompt:i}=e,[r,n]=b.useState(!0),a=()=>{n(!r)},[o,c]=b.useState(!1),u=b.useMemo(()=>r?t.slice(0,6):t,[t,r]),m=b.useMemo(()=>t.length>6,[t]),p=b.useMemo(()=>{let e=0;for(let l of t)if("subject"!==l.type&&("modifier"===l.type&&e++,"theme"===l.type)){let s=l.data.modifiers;for(let i of s)"subject"!==i.type&&e++}return e},[t]),x=b.useMemo(()=>{for(let e of t)if("theme"===e.type)return!0;return!1},[t]),h=b.useMemo(()=>(0,d.X)(i)||"",[i]);return(0,s.jsxs)("div",{className:"",children:[l&&(0,s.jsxs)("button",{onClick:()=>{p>0&&a()},className:"lg:hover:ring-[1px] ring-inset lg:hover:ring-blue-500 w-full px-6 py-2 flex items-center gap-2 text-muted-foreground text-xs font-medium ".concat(0===p?"cursor-default":""),children:[p>0&&(r?(0,s.jsx)(A.mfX,{size:16}):(0,s.jsx)(A.QBW,{size:16})),0===p?"No excluded styles":"Excluded (".concat(p,")")]})||(0,s.jsx)("div",{className:"text-sm leading-5 font-medium px-6 py-1",children:0===p?"No applied styles":"Styles used (".concat(p,")")}),(0,s.jsxs)("div",{className:(0,z.Z)("flex flex-col gap-0 ".concat(l?"ml-6":""),{hidden:l&&r}),children:[u.map(e=>{switch(e.type){case"subject":return x?null:(0,s.jsx)(U,{isNegative:l,Icon:T.OpK,colorClassName:"text-dark:text-indigo-300 text-indigo-700",text:h},"subject");case"modifier":return(0,s.jsx)(U,{Icon:R.BlD,text:e.data.name,colorClassName:"text-foreground",isNegative:l},e.data.id);case"theme":return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{onClick:()=>c(!o),className:"group flex flex-row items-center p-0 gap-2 w-full px-6 py-2 content-between lg:hover:ring-[1px] ring-inset lg:hover:ring-blue-500 hover:cursor-default",children:(0,s.jsxs)("div",{className:"w-full flex flex-row items-center p-0 gap-2",children:[(0,s.jsx)("div",{className:"-ml-5 -mr-1 w-4 h-4 item-center justify-center",children:o?(0,s.jsx)(A.QBW,{className:"text-muted-foreground cursor-pointer w-4 h-4",name:"triangleArrowDown"}):(0,s.jsx)(A.mfX,{className:"text-muted-foreground cursor-pointer w-4 h-4",name:"triangleArrowDown"})}),(0,s.jsx)("div",{className:"w-4 h-4",children:(0,s.jsx)(T.y6p,{className:"dark:text-emerald-200 text-emerald-700",size:16})}),(0,s.jsx)("div",{className:"flex flex-col items-start p-0",children:(0,s.jsx)("span",{className:"text-xs leading-5 font-normal dark:text-emerald-200 text-emerald-700 w-full line-clamp-1",children:e.data.name})})]})},e.data.id),(0,s.jsx)("div",{className:(0,z.Z)("".concat(l?"":"ml-6"),{hidden:!o}),children:e.data.modifiers.map(e=>(0,s.jsx)(U,{isNegative:l,Icon:R.BlD,text:"subject"===e.type?h:e.name,colorClassName:"subject"===e.type?"text-dark:text-indigo-300 text-indigo-700":"dark:text-emerald-200 text-emerald-700"},e.id))})]})}}),!l&&m&&(0,s.jsxs)("button",{onClick:a,className:"hover:bg-white/10 flex gap-2 mt-1 rounded-full w-fit text-left text-xs font-medium text-muted-foreground px-2 py-1 mx-4 mb-2",children:[(0,s.jsx)(Z.K9M,{className:"text-muted-foreground",size:16}),r?"View all":"View less"]})]})]})};var H=l(7297),F=l(30313);let W=e=>{let t=[];if(!e)return t;let l=e.split(/[.,|\/;+]/);return l.forEach(e=>t.push(e.trim())),t.filter(e=>e)};var Y=l(19521);function V(){let e=(0,H.Z)(["\n  transition: background-color 0.1s;\n  :hover {\n    cursor: pointer;\n    background-color: #0c8ce9;\n  }\n"]);return V=function(){return e},e}let K=(0,Y.ZP)(F.xv).withConfig({componentId:"sc-5ab05dd2-0"})(V()),q=[250,160,280],B=e=>{let{prompt:t,skeleton:l}=e,i=W(t),[r,n]=(0,b.useState)(!0),a=(0,b.useMemo)(()=>i.length>99999,[i]),o=(0,b.useMemo)(()=>r?i.slice(0,99999):i,[r,i]);return l?(0,s.jsxs)(F.kC,{flexDirection:"column",children:[(0,s.jsx)(y.Z,{width:69,height:8}),(0,s.jsx)(F.kC,{flexDirection:"row",flexWrap:"wrap",children:q.map(e=>(0,s.jsx)(y.Z,{width:e,height:12,style:{marginRight:"8px"}},e))})]}):(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(F.kC,{flexDirection:"column",children:[(0,s.jsx)("label",{className:"text-muted-foreground text-[10px] font-medium uppercase tracking-widest flex mb-1 mt-4",children:"Prompt"}),(0,s.jsxs)(F.xu,{children:[o.map((e,t)=>(0,s.jsxs)("span",{children:[(0,s.jsx)(g(),{href:{pathname:"/search",query:{q:e.toLowerCase()}},passHref:!0,children:(0,s.jsx)(K,{className:"text-md md:text-xl !text-foreground",children:e})}),t<o.length-1&&(0,s.jsxs)(F.xv,{className:"text-md md:text-xl text-foreground",color:"white",opacity:.8,lineHeight:"28px",children:[","," "]})]},"".concat(e,"_").concat(t))),a&&(r?(0,s.jsx)(F.W4,{onClick:()=>n(!1),alignSelf:"flex-start",style:{cursor:"pointer"},children:(0,s.jsx)(F.xv,{className:"bg-red-500 px-4 text-md md:text-xl font-bold flex ml-2 mt-1",color:"white",children:"More"})}):(0,s.jsx)(F.W4,{className:"px-4",onClick:()=>n(!0),alignSelf:"flex-start",style:{cursor:"pointer"},children:(0,s.jsx)(F.xv,{className:"bg-red-500 px-4 text-md md:text-xl font-bold flex ml-2 mt-1",color:"white",children:"Less"})}))]})]})})};var J=l(76445),$=l(99461),G=l(94661),Q=l(94991),X=l(18318),ee=l(77182),et=l(16841),el=l(20084),es=l(16605);let ei=e=>{let{prompt:t,isRestricted:l,onCopyComplete:i}=e,{copy:r}=(0,Q.FU)(),{toast:n}=(0,ee.pm)(),{isLoggedIn:a}=(0,Q.kP)(),{setIsLogInModalOpen:o}=(0,et.l9)(),d=(0,b.useCallback)(()=>{if(!a){o(!0);return}l?n({description:"This prompt is restricted and cannot be copied."}):(r(t),n({description:"Prompt copied to clipboard!",variant:"success"}),null==i||i(),(0,el.L9)(es._.promptCopied,{promptId:t}))},[t,l,i,r,n,a,o]);return(0,s.jsxs)(_.z,{onClick:d,variant:"outline",className:"shrink-0",children:[(0,s.jsx)(X.On2,{className:"mr-2"}),"Copy prompt"]})},er=e=>{var t,l,i;let{data:r,display:n}=e;if(!r||!n)return(0,s.jsxs)("div",{className:"flex justify-start items-center flex-grow",children:[(0,s.jsx)("div",{className:"flex justify-start items-start flex-grow-0 flex-shrink-0 relative gap-4 pr-3",children:(0,s.jsx)(y.Z,{style:{borderRadius:48},width:48,height:48})}),(0,s.jsx)("div",{className:"flex justify-start items-center flex-grow gap-3",children:(0,s.jsxs)("div",{className:"flex flex-col justify-center items-start flex-grow",children:[(0,s.jsx)(y.Z,{width:200,height:8}),(0,s.jsx)(y.Z,{width:100,height:8})]})})]});let a=(0,c.p)(new Date(r.createdAt));return(0,s.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 md:items-center w-full",children:[(0,s.jsxs)("div",{className:"flex justify-start items-center flex-grow gap-x-4",children:[(0,s.jsxs)("div",{className:"flex justify-start items-start flex-grow-0 flex-shrink-0 relative gap-4",children:[(0,s.jsx)($.Z,{seed:r.id.slice(-8),image:(null==r?void 0:r.user)&&(null==r?void 0:r.user.username)!=="prompthunt"?null==r?void 0:null===(t=r.user)||void 0===t?void 0:t.image:null===(l=r.provider)||void 0===l?void 0:l.image,width:48,height:48}),(null==r?void 0:r.user)&&(null==r?void 0:r.user.username)!=="prompthunt"&&(0,s.jsx)("div",{className:"ring-2 ring-background absolute flex justify-center items-center right-0 bottom-0 bg-muted bg-gradient-to-r from-[#1F1F1F]/50 to-[#363636]/50 rounded-full overflow-hidden translate-y-1/3 translate-x-1/3",children:(0,s.jsx)($.Z,{seed:r.id.slice(-8),image:null===(i=r.provider)||void 0===i?void 0:i.image,width:24,height:24})})]}),(0,s.jsx)("div",{className:"flex justify-start items-center flex-grow gap-3",children:(0,s.jsxs)("div",{className:"flex flex-col gap-0.5 justify-center items-start flex-grow relative",children:[(0,s.jsx)("p",{className:(0,z.Z)("text-muted-foreground text-xs leading-4 font-normal overflow-x-auto",(null==r?void 0:r.user)&&(null==r?void 0:r.user.username)!=="prompthunt"&&"order-1"),children:(null==r?void 0:r.user)&&(null==r?void 0:r.user.username)!=="prompthunt"&&(0,s.jsx)("span",{className:"font-semibold gap-1",children:(0,s.jsx)(J.$,{meta:r.meta,provider:r.provider||void 0})})}),(0,s.jsxs)("div",{className:"flex gap-x-2 items-center",children:[(0,s.jsx)("label",{className:"self-stretch flex-grow-0 flex-shrink-0 text-base font-medium text-left text-foreground",children:(null==r?void 0:r.user)&&(null==r?void 0:r.user.username)!=="prompthunt"?(0,s.jsx)(g(),{href:"/user/".concat(null==r?void 0:r.user.username),children:null==r?void 0:r.user.username}):r.provider.name}),(null==r?void 0:r.user)&&(null==r?void 0:r.user.username)!=="prompthunt"&&(0,s.jsx)(G.Z,{subscriptionPlan:null==r?void 0:r.user.subscriptionPlan}),(0,s.jsx)("label",{className:"text-sm font-normal text-muted-foreground",children:a})]})]})})]}),(0,s.jsx)(ei,{prompt:r.prompt||"",isRestricted:r.isRestricted,onCopyComplete:()=>console.log("Prompt copied!")})]})};var en=l(43633),ea=l(96486),eo=l.n(ea),ed=l(86512),ec=l(48233),eu=l(97435),em=l(50207),ep=l(10615);l(12755);var ex=l(41576),eh=l(36492);async function ef(e,t,l,s,i,r){let n=await fetch(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"public",l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10,i=arguments.length>4?arguments[4]:void 0,r=arguments.length>5?arguments[5]:void 0,n="/api/user/".concat(e,"/prompts"),a="object"==typeof r&&Object.keys(r).length>0?Object.keys(r).map(e=>"exclude".concat(e.charAt(0).toUpperCase()+e.slice(1),"=true")).join("&"):"",o="page=".concat(l,"&limit=").concat(s,"&filter=").concat(t);return(i&&(o+="&orderBy=".concat(i)),a)?"".concat(n,"?").concat(o,"&").concat(a):"".concat(n,"?").concat(o)}(e,t,l,s,i,r),{credentials:"include",method:"GET",headers:{"Content-Type":"application/json"}});return n.json()}let ev=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"public",l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,s=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,r=arguments.length>5?arguments[5]:void 0;return(0,eh.a)(["promptsV2",e,t,l],()=>Promise.all(Array.from({length:l}).map((l,r)=>ef(e,t,r+1,10,s,i))).then(e=>({prompts:e.flatMap(e=>e.prompts)})),{...r,staleTime:3e5})};function eg(e){let{userId:t}=e,{data:l,isLoading:i,isError:r,error:n}=ev(t),a=b.useMemo(()=>l?eo().sampleSize(l.prompts,9):[],[l]);return i?(0,s.jsx)("div",{children:(0,s.jsx)("div",{className:"grid grid-cols-3 gap-0 relative h-fit animate-pulse",children:Array.from({length:3}).map((e,t)=>(0,s.jsx)("div",{className:"rounded-none aspect-square w-full bg-primary/10 ring-inset ring-1 ring-card"},t))})}):r?(0,s.jsxs)("div",{className:"text-center text-xs text-foreground/50",children:["There was an error fetching more posts: ",n.message]}):null==l||null==t?null:(0,s.jsx)("div",{className:"grid grid-cols-3 gap-0 relative h-fit",children:a.map(e=>(0,s.jsx)("div",{children:(0,s.jsx)(ex.Z,{width:200,data:e,squareCrop:!0,disableDataOverlay:!0})},e.id))})}var ej=l(73047);let ew=e=>{var t,l,p,h,v,w,y,P,I,R,M,A,Z,O,D,U,H,F,W,Y,V,K,q,J,$,G;let{isModal:X,promptId:ee}=e,{isLoggedIn:el}=(0,Q.kP)(),es=(0,j.useRouter)(),ei=(0,Q.Wd)("prompt"),eo=(0,ec.d)(),{showNsfw:ex,setShowNsfw:eh}=(0,et.nf)(),ef=ee||ei,{prompt:ev,isLoading:ew}=(0,n.R4)(ef,{staleTime:1/0,onError:()=>{es.push("/404")},retry:!1}),eN=(0,Q.rY)({promptUserId:null===(t=ev.user)||void 0===t?void 0:t.id}),[ey,eC]=(0,b.useState)(!1),ek=(0,Q.Wd)("selectedAsset"),[eP,eI]=(0,b.useState)(0),eR=(0,b.useMemo)(()=>{var e,t;return null===(e=ev.theme)||void 0===e?void 0:null===(t=e.meta)||void 0===t?void 0:t.pixelArt},[null===(l=ev.theme)||void 0===l?void 0:l.meta]);(0,b.useEffect)(()=>{var e;(null===(e=ev.assets)||void 0===e?void 0:e.length)&&ev.assets[eP]&&es.replace({pathname:es.pathname,query:{...es.query,selectedAsset:ev.assets[eP].id}},void 0,{shallow:!0})},[eP]);let eM=(0,b.useMemo)(()=>{var e;return!!ev&&null!==(e=ev.assets)&&void 0!==e&&!!e.length&&ev.assets.length>1},[ev]);(0,b.useEffect)(()=>{(0,eu._V)(ev.id,ev.comments)},[ev]),(0,b.useEffect)(()=>{var e,t,l,s;eC(!((null===(e=null===(t=ev.meta)||void 0===t?void 0:t.valueOf())||void 0===e?void 0:null===(l=e.modifiers)||void 0===l?void 0:l.length)>0));let i=null===(s=ev.assets)||void 0===s?void 0:s.findIndex(e=>e.id===ek);-1!==i&&void 0!=i&&eI(i)},[ek,ev.assets,ev.meta]);let eS=()=>{eP<ev.assets.length-1?eI(eP+1):eI(0)},e_=()=>{eP>0?eI(eP-1):eI(ev.assets.length-1)},eE=(null===(p=null===(h=ev.meta)||void 0===h?void 0:h.valueOf())||void 0===p?void 0:null===(v=p.modifiers)||void 0===v?void 0:v.length)>0,ez=(null==ev?void 0:ev.meta)?(0,d.X)(ev):"",eA=null===(w=ev.user)||void 0===w?void 0:w.username,eT=(0,b.useMemo)(()=>ev&&ev.prompt?(0,o.M)(ev):[],[ev]),eZ=(0,b.useMemo)(()=>{if(!ev||!ev.prompt)return[];let e=(0,ea.get)(ev,"meta.negativeStyles",[]),t=e.filter(e=>"modifier"===e.type).map(e=>e.data),l=t.map(e=>({type:"modifier",data:e,id:e.id,enabled:"boolean"!=typeof e.enabled||e.enabled}));return l},[ev]),eO=(0,b.useCallback)(()=>{var e,t;(null===(e=ev.theme)||void 0===e?void 0:e.id)&&eo(null===(t=ev.theme)||void 0===t?void 0:t.id)},[null===(y=ev.theme)||void 0===y?void 0:y.id,eo]),eD=(0,b.useMemo)(()=>{var e,t;if(ev.assets)return(null==ev?void 0:null===(e=ev.assets)||void 0===e?void 0:e[eP])||(null==ev?void 0:null===(t=ev.assets)||void 0===t?void 0:t[0])},[ev,eP]),eU=(0,b.useMemo)(()=>{var e;if(!(null===(e=ev.reusePrompt)||void 0===e?void 0:e.prompt))return null;let t=(0,d.X)({prompt:ev.reusePrompt.prompt,meta:ev.meta});return t},[ev.meta,null==ev?void 0:null===(P=ev.reusePrompt)||void 0===P?void 0:P.prompt]),eL=(0,b.useMemo)(()=>null!=ev&&!!ev.prompt&&((0,em.c)(ev.prompt)||ev.isNsfw),[ev.isNsfw,ev.prompt]);if(ew||!(null==ev?void 0:ev.assets))return null;let eH=e=>{(0,n.so)({id:e.promptId,assets:ev.assets.map(t=>t.id===e.id?e:t)})};return(0,s.jsxs)(C.Z,{noNavBar:X,children:[(0,s.jsx)(m.PB,{title:eA+": "+(ez||"Prompt Hunt - Your home for exploring, creating, and sharing AI art"),description:"Create, explore, and share AI art using Stable Diffusion, DALL\xb7E, and Midjourney",openGraph:{title:eA+": "+(ez||"Prompt Hunt - Your home for exploring, creating, and sharing AI art"),description:"Create, explore and share AI art using Stable Diffusion, DALL\xb7E, and Midjourney",images:ev.assets.map(e=>({url:null!==($=e.cfUrl)&&void 0!==$?$:e.src,type:"image/png",secureUrl:null!==(G=e.cfUrl)&&void 0!==G?G:e.src,width:e.width,height:e.height,alt:ez})),type:"article"},twitter:{cardType:"summary_large_image"}}),(0,s.jsxs)(x(),{children:[(0,s.jsx)("meta",{name:"twitter:image",content:"/api/image/".concat(ef)}),(0,s.jsx)("meta",{name:"twitter:card",content:"summary_large_image"})]}),(0,s.jsxs)("div",{className:"flex flex-col w-fit items m-auto pb-10 lg:pb-24 lg:min-w-[1024px]",children:[(0,s.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,s.jsx)(er,{data:ev,display:["flex"]})}),(0,s.jsxs)("div",{className:"flex flex-col lg:flex-row justify-center lg:space-x-10 bg-red-500/0",children:[(0,s.jsx)("div",{className:"bg-red-500/0 w-fit flex flex-col",children:(0,s.jsx)("div",{className:"w-fit flex flex-column gap-y-10 lg:gap-y-6",children:(0,s.jsx)("div",{className:"w-full m-auto ",children:ev&&ev?(0,s.jsxs)("div",{className:"flex flex-col gap-y-6 lg:gap-y-10 relative",children:[(0,s.jsx)("div",{className:"w-full relative justify-center items-center",children:(0,s.jsx)("div",{className:"flex object-contain max-w-3xl w-fit m-auto group relative",children:(0,s.jsx)("div",{className:(0,ej.cn)("items-center md:-mx-0 overflow-visible","-mx-4"),children:eD&&(0,s.jsxs)("div",{className:(0,z.Z)("flex max-w-3xl w-fit md:rounded-lg overflow-hidden relative items-center justify-center",eD.width<eD.height&&"max-w-[50vh]"),children:[(0,s.jsx)("div",{className:"aspect-w-1 relative aspect-h-1 !w-fit max-w-full",children:(0,s.jsxs)("div",{className:"group relative !w-fit",children:[eL&&(0,s.jsx)("div",{className:"absolute top-4 left-4 z-[100] flex gap-4",children:(0,s.jsxs)("button",{onClick:()=>eh(!ex),className:"text-xs p-2 bg-red-400 rounded-full flex items-center justify-center gap-1",children:["NSFW ",ex?(0,s.jsx)(T.rCC,{}):(0,s.jsx)(T.I$m,{})]})}),eN&&(0,s.jsx)(ed.C,{onUpdate:eH,asset:eD,prompt:ev,index:eP}),(0,s.jsx)("div",{children:(0,s.jsx)(ep.lr,{className:"bg-black/10 aspect-w-1 aspect-h-1 object-contain",showStatus:!1,showThumbs:!1,infiniteLoop:!1,verticalSwipe:"natural",autoPlay:!1,preventMovementUntilSwipeScrollTolerance:!0,swipeScrollTolerance:50,swipeable:!0,showArrows:!1,emulateTouch:!0,showIndicators:!!eM,selectedItem:eP,onChange:e=>eI(e),width:"100%",children:ev.assets.map(e=>(0,s.jsx)("div",{className:"flex aspect-w-1 aspect-h-1 md:max-h-[80vh]",children:(0,s.jsx)(f(),{unoptimized:!0,src:e.cfUrl||e.src,alt:ev.prompt||"",className:(0,z.Z)("object-contain",{"blur-2xl":eL&&!ex}),width:e.width,height:e.height,quality:100,blurDataURL:"data:image/svg+xml;base64,".concat((0,r.K)(e.width,e.height)),style:{imageRendering:eR?"pixelated":"auto"}})},e.id))})})]})}),eM&&(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"invisible lg:group-hover:visible z-10 absolute px-6 flex w-full h-fit self-center items-center justify-between",children:[(0,s.jsx)("button",{onClick:e_,className:"w-10 h-10 rounded-full outline-none bg-white text-black items-center hover:scale-125 transform transition-transform duration-300",children:(0,s.jsx)(N.bUI,{size:16,className:"ml-2.5"})}),(0,s.jsx)("button",{onClick:eS,className:"w-10 h-10 rounded-full outline-none bg-white text-black items-center hover:scale-125 transform transition-transform duration-300",children:(0,s.jsx)(N.Dli,{size:16,className:"ml-3"})})]})})]})})})}),eM&&(0,s.jsx)("div",{className:"flex justify-center gap-3 flex-wrap",children:ev.assets.map((e,t)=>(0,s.jsx)("div",{className:"relative ".concat(t===eP?"border-2 border-white":""," w-16 h-16 overflow-hidden rounded-lg lg:hover:opacity-80 lg:hover:scale-110 transition-transform"),children:(0,s.jsx)("img",{alt:ev.prompt?ev.prompt+t:"",src:e.cfUrl||e.src,className:"w-full h-full cursor-pointer object-cover ".concat(eL?"blur-2xl":""),onClick:()=>{eI(t)}})},(e.cfUrl||e.src)+t))}),ev.isRestricted&&(0,s.jsxs)("div",{className:" flex flex-col justify-center items-center gap-y-4",children:[(0,s.jsxs)("div",{className:"max-w-3xl flex justify-center items-center text-muted-foreground font-semibold rounded-lg gap-x-2 bg-muted py-2.5 px-4 w-full",children:[(0,s.jsx)(a.Z,{name:"lockLocked",size:18}),"Prompt hidden"]}),(0,s.jsxs)("span",{className:"text-muted-foreground text-sm font-medium text-center",children:[null===(I=ev.user)||void 0===I?void 0:I.username," has hidden all details about this creation"]})]}),(0,s.jsx)("div",{className:"w-full flex justify-center",children:(0,s.jsx)("div",{className:"w-full max-w-lg flex items-center gap-x-4",children:(0,s.jsx)(en.x,{prompt:ev,moreActionsConfig:{delete:{show:!0,args:null},copy:{show:!0,args:null},private:{show:!0,args:null}},actionsConfig:{restrict:{show:!0,args:null},copy:{show:!1,args:null}}})})}),(0,s.jsxs)("div",{className:"w-full m-auto max-w-xl flex flex-col gap-y-10 mb-4 lg:mb-0 justify-center items-center",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-y-2 w-full text-left justify-start",children:[eE&&!ev.isRestricted&&ev.prompt&&(0,s.jsx)("h4",{className:"text-xl mb-0",children:ez}),(0,s.jsx)(u.M,{children:ey&&!ev.isRestricted&&ev.prompt&&(0,s.jsx)(B,{prompt:ev.prompt})}),eE&&!ev.isRestricted&&(0,s.jsx)("div",{children:(0,s.jsx)(_.z,{variant:"link",onClick:()=>eC(!ey),className:"px-0 h-fit",children:ey?"Hide prompt":"View prompt"})}),(0,s.jsx)("label",{className:"text-muted-foreground text-[10px] font-medium uppercase tracking-widest flex mb-1",children:(0,c.p)(new Date(ev.createdAt))})]}),(null==ev?void 0:ev.reusePrompt)&&(null==ev?void 0:null===(R=ev.reusePrompt)||void 0===R?void 0:R.id)&&!ev.isRestricted&&(0,s.jsx)("div",{className:"flex w-full",children:(0,s.jsx)(S.Zb,{className:"w-full",children:(0,s.jsx)(S.aY,{className:"pt-6",children:(0,s.jsxs)("div",{className:"flex justify-start items-center gap-4",children:[(0,s.jsx)(g(),{target:"_blank",href:"/prompt/".concat(null==ev?void 0:ev.reusePrompt.id),children:(0,s.jsx)("div",{className:"flex w-[100px] h-[100px] rounded-lg aspect-square overflow-hidden cursor-zoom-in",children:(0,s.jsx)("img",{src:(null==ev?void 0:null===(M=ev.reusePrompt)||void 0===M?void 0:null===(A=M.assets)||void 0===A?void 0:A[0].cfUrl)||(null==ev?void 0:null===(Z=ev.reusePrompt)||void 0===Z?void 0:null===(O=Z.assets)||void 0===O?void 0:O[0].url)||"",alt:"Creation",className:"border-transparent bg-neutral-700 object-cover w-full h-full object-center hover:opacity-80 hover:scale-110 transform transition duration-500"})})}),(0,s.jsxs)("div",{className:"w-fit flex flex-col justify-start items-start relative",children:[(0,s.jsx)("label",{className:"text-muted-foreground text-[10px] font-medium uppercase tracking-widest mb-1",children:"Original Creation"}),(0,s.jsx)("div",{className:"flex flex-col justify-start items-start",children:(0,s.jsx)("div",{className:"flex justify-start items-start gap-2",children:(0,s.jsxs)(g(),{href:"/prompt/".concat(null==ev?void 0:ev.reusePrompt.id),children:[(0,s.jsx)("p",{className:"text-sm text-left text-foreground/80 line-clamp-2 mb-1",children:eU})," "]})})}),(0,s.jsxs)(g(),{href:"/user/".concat(ev.reusePrompt.user.username),className:"text-muted-foreground text-xs leading-5 font-normal lg:hover:underline",children:["by ",(0,s.jsxs)("span",{children:["@",ev.reusePrompt.user.username]})]})]})]})})})}),(0,s.jsx)(i.F,{parentId:ev.id,parentUserId:null===(D=ev.user)||void 0===D?void 0:D.id,type:"prompt"})]})]}):(0,s.jsx)(eb,{})})})}),(0,s.jsx)("div",{children:(0,s.jsxs)("div",{className:"flex flex-col w-full lg:w-80 gap-2 bg-red-500/0",children:[(0,s.jsxs)(S.Zb,{children:[(0,s.jsx)(S.Ol,{children:(0,s.jsxs)(S.ll,{className:"text-sm leading-5 font-medium",children:["More by"," ",(0,s.jsx)(g(),{href:"/user/".concat(null===(U=ev.user)||void 0===U?void 0:U.username),passHref:!0,className:"underline",children:null===(H=ev.user)||void 0===H?void 0:H.username})]})}),(0,s.jsxs)(S.aY,{children:[" ",(null===(F=ev.user)||void 0===F?void 0:F.id)&&(0,s.jsx)(eg,{userId:null===(W=ev.user)||void 0===W?void 0:W.id})]})]}),!ev.isRestricted&&(0,s.jsxs)(s.Fragment,{children:[(null==ev?void 0:ev.theme)&&(null==ev?void 0:ev.theme.id)&&!ev.isRestricted&&(0,s.jsx)(S.Zb,{children:(0,s.jsx)(S.aY,{className:"pt-6",children:(0,s.jsx)("div",{className:"flex flex-col gap-4",children:(0,s.jsxs)("div",{className:"flex justify-start items-center self-stretch gap-4",children:[(0,s.jsx)(g(),{href:"/theme/".concat(null==ev?void 0:ev.theme.id),className:"w-fit",children:(0,s.jsx)("div",{className:"overflow-clip border-transparent h-16 w-16 flex-none rounded-lg bg-neutral-700 object-cover object-center aspect-square",children:(0,s.jsx)(f(),{unoptimized:!0,alt:"",width:100,height:100,src:(null==ev?void 0:ev.theme.image)||"",className:""})})}),(0,s.jsxs)("div",{className:"flex flex-col justify-start items-start grow shrink relative",children:[(0,s.jsx)("label",{className:"text-muted-foreground text-[10px] font-medium uppercase tracking-widest mb-1",children:"TEMPLATE USED"}),(0,s.jsx)("div",{className:"flex flex-col justify-start items-start grow shrink",children:(0,s.jsx)("div",{className:"flex justify-start items-start grow shrink relative gap-2",children:(0,s.jsx)(g(),{href:"/theme/".concat(null==ev?void 0:ev.theme.id),children:(0,s.jsx)("p",{className:"grow shrink text-sm text-left line-clamp-1",children:ev.theme.name})})})})]}),(0,s.jsx)(_.z,{size:"sm",variant:"accent",onClick:eO,children:"Try"})]})})})}),(0,s.jsx)(S.Zb,{children:(0,s.jsxs)(S.aY,{className:"py-4 px-0",children:[eT&&!ev.isRestricted&&ev.prompt?(0,s.jsx)(L,{styles:eT,prompt:ev}):null,eZ&&!ev.isRestricted&&ev.prompt?(0,s.jsx)(L,{isNegative:!0,styles:eZ,prompt:ev}):null]})}),!ev.isRestricted&&(null===(Y=ev.assets)||void 0===Y?void 0:Y[0])&&(0,s.jsx)(E,{id:ev.id,meta:ev.meta,width:ev.assets[0].width,height:ev.assets[0].height,name:null==ev?void 0:null===(V=ev.provider)||void 0===V?void 0:V.name,selectedAssetUrl:null===(K=ev.assets[eP])||void 0===K?void 0:K.src})]})]})})]})]}),(0,s.jsx)("div",{className:"flex flex-col gap-y-6",children:(0,s.jsx)("div",{className:"flex flex-col gap-y-6 lg:gap-y-10 mb-6",children:(0,s.jsx)("p",{className:"text-[10px] lg:text-2xl font-medium text-left lg:text-center uppercase lg:normal-case text-muted-foreground tracking-wider lg:tracking-normal",children:"More prompts"})})}),el?(0,s.jsx)(k.Z,{themeId:null===(q=ev.theme)||void 0===q?void 0:q.id,query:"",excludePrompt:ev.id}):(0,s.jsx)("div",{className:"-mb-96 md:-mb-20",children:(0,s.jsx)(k.Z,{themeId:null===(J=ev.theme)||void 0===J?void 0:J.id,query:"",excludePrompt:ev.id,disableFetchMore:!0})})]})},eb=()=>(0,s.jsxs)(F.rj,{gridTemplateColumns:["1fr"],gridGap:[6,null,9],mb:"48px",children:[(0,s.jsx)(F.xu,{height:[350,450,750],children:(0,s.jsx)(y.Z,{height:"100%",style:{borderRadius:16}})}),(0,s.jsx)(F.kC,{flexDirection:"column",justifyContent:"space-between",children:(0,s.jsx)(F.kC,{flexDirection:"column",children:(0,s.jsx)(B,{prompt:"",skeleton:!0})})})]});var eN=!0,ey=ew},72146:function(e,t,l){l.d(t,{G:function(){return s}});let s=(e,t)=>{let l="square",s="standard";return e>t?l="wide":e<t&&(l="tall"),(e>768||t>768||768===e&&768===t)&&(s="large"),{canvas:l,output:s}}},91254:function(e,t,l){l.d(t,{M:function(){return r}});var s=l(96486),i=l(41695);let r=e=>{var t;let l=[],r=(0,i.X)(e),n=(0,s.cloneDeep)((0,s.get)(e,"meta.modifiers",[])),a="string"==typeof e.themeId,o=(0,s.cloneDeep)((0,s.get)(e,"theme.modifiers",null)),d=null===(t=null==o?void 0:o.find(e=>"theme"===e.type))||void 0===t?void 0:t.data,c=null==d?void 0:d.modifiers;c&&(null==o||o.push(...c));let u=r?e.prompt.indexOf(r):0,m=n.map(t=>e.prompt.indexOf(t.name)),p=0;for(let x=0;x<m.length;x++)if(u<m[x]){p=x;break}for(let h of(n.splice(p,0,{id:"subject",name:r||"",type:"subject",enabled:!0,categories:[],strength:0,verified:!0}),n))if(h.type){if("modifier"===h.type){if(a&&o){let f=o.find(e=>e.id===h.id);f?e.themeId&&!l.find(e=>"theme"===e.type)&&l.push({id:e.themeId,type:"theme",data:e.theme,enabled:!0}):l.push({id:h.id,type:"modifier",data:h,enabled:!0})}else l.push({id:h.id,type:"modifier",data:h,enabled:!0})}else"subject"===h.type&&l.push({id:"subject",type:"subject",data:"subject",enabled:!!h.enabled,weight:h.weight||"100%"})}else l.push({id:h.id,type:"modifier",data:h,enabled:!0});return l}}}]);
//# sourceMappingURL=7811-c3a38b04869517c8.js.map